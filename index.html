
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Pole Inspector — iOS Scanner Flow</title>
  <meta name="theme-color" content="#0b5ed7" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Pole Inspector</h1>
    <p>Use iOS Code Scanner (Control Center) to open this page with the pole code, or paste a code directly. Edit height, status, species, GPS and photos.</p>
  </header>

  <main>
    <section id="scan-section">
      <div class="card">
        <h2>Code</h2>
        <div class="controls">
          <input id="f-id" class="code-input" placeholder="e.g., NS-7003-001" />
          <button id="btn-paste">Paste</button>
          <button id="btn-clear">Clear</button>
        </div>
        <div class="hint small">
          iPhone tip: Open <b>Control Center → Code Scanner</b> and scan a QR that encodes a URL like:<br/>
          <code>https://YOUR-SITE/?id=NS-7003-001</code> or <code>https://YOUR-SITE/#NS-7003-001</code>.<br/>
          This page will auto-fill based on <b>id</b> or <b>#hash</b>.
        </div>
        <div id="scan-help" class="hint small hidden"></div>
      </div>
    </section>

    <section id="form-section">
      <div class="card">
        <h2>Record</h2>
        <form id="pole-form">
          <div class="grid">
            <label>Height (m)
              <input id="f-height" type="number" step="0.1" min="0" placeholder="e.g., 12.5" />
            </label>

            <label>Status
              <select id="f-status">
                <option value="">— Select —</option>
                <option value="OK">OK</option>
                <option value="Watch">Watch</option>
                <option value="Repair">Repair</option>
                <option value="Replace">Replace</option>
              </select>
            </label>

            <label>Species
              <select id="f-species">
                <option value="">— Select —</option>
                <option value="SYP">SYP</option>
                <option value="DF">DF</option>
                <option value="RP">RP</option>
                <option value="WRC">WRC</option>
                <option value="Unknown">Unknown</option>
              </select>
            </label>

            <label>Calc Equivalent Dia (%)
              <input id="f-calc-dia-pct" type="number" step="0.1" min="0" max="100" placeholder="Optional, 0–100" />
            </label>

            <label>Latitude
              <input id="f-lat" inputmode="decimal" placeholder="Auto or manual" />
            </label>

            <label>Longitude
              <input id="f-lng" inputmode="decimal" placeholder="Auto or manual" />
            </label>

            <label>Accuracy (m)
              <input id="f-acc" inputmode="decimal" placeholder="Auto" />
            </label>

            <label>Notes
              <textarea id="f-notes" rows="3" placeholder="Optional"></textarea>
            </label>

            <label>Updated At
              <input id="f-updated" disabled />
            </label>
          </div>

          <div class="controls">
            <button type="button" id="btn-locate">Get current location</button>
            <button type="submit" id="btn-save">Save</button>
            <button type="button" id="btn-new">New</button>
            <button type="button" id="btn-delete" class="danger">Delete</button>
          </div>

          <div class="photos">
            <h3>Photos</h3>
            <div class="controls">
              <button type="button" id="btn-photo-attach">Attach photo</button>
              <button type="button" id="btn-photo-insert">Insert photo into notes</button>
              <input type="file" id="photo-file" accept="image/*" capture="environment" hidden />
            </div>
            <div id="photo-grid" class="photo-grid"></div>
          </div>
        </form>
      </div>
    </section>

    <section id="list-section">
      <div class="card">
        <h2>Data</h2>
        <div class="controls">
          <input id="search" placeholder="Filter by code (fuzzy match)" />
          <button id="btn-export">Export CSV</button>
          <label class="file-label">
            Import CSV
            <input type="file" id="import-file" accept=".csv,text/csv" hidden />
          </label>
        </div>
        <div class="table-wrap">
          <table id="data-table">
            <thead>
              <tr>
                <th>Code</th><th>Height(m)</th><th>Status</th><th>Species</th><th>Calc Dia (%)</th><th>Lat</th><th>Lng</th><th>Acc(m)</th><th>Photos</th><th>Updated</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <small>Offline-capable. Data is saved to this device (IndexedDB).</small>
  </footer>

  <script src="app.js"></script>
</body>
</html>
